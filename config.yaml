# Default configuration for local development
# For Docker deployment, see config.docker.yaml

server:
  host: "0.0.0.0"
  port: 8080
  read_timeout: 30s
  write_timeout: 30s
  idle_timeout: 120s

valkey:
  host: "localhost"
  port: 6379
  password: ""
  db: 0
  max_retries: 3
  pool_size: 10
  min_idle_conns: 5

cache:
  default_ttl: 300s
  max_ttl: 3600s
  # Endpoint-specific cache configurations
  endpoints:
    - path: "/api/v1/users"
      methods: ["GET"]
      ttl: 600s
      cache_key_headers: ["Authorization"]
      cache_key_query_params: ["page", "limit"]
    - path: "/api/v1/products"
      methods: ["GET"]
      ttl: 1800s
      cache_key_query_params: ["category", "sort"]
    - path: "/api/v1/search"
      methods: ["GET"]
      ttl: 300s
      cache_key_query_params: ["q", "filter"]

rate_limit:
  enabled: true
  requests_per_second: 100
  burst: 200
  # Per-endpoint rate limits
  endpoints:
    - path: "/api/v1/search"
      requests_per_second: 10
      burst: 20

retry:
  enabled: true
  max_attempts: 3
  initial_backoff: 100ms
  max_backoff: 2s
  backoff_multiplier: 2.0
  retryable_status_codes: [500, 502, 503, 504]

upstream:
  base_url: "http://localhost:9000"
  timeout: 30s
  max_idle_conns: 100
  max_conns_per_host: 10

logging:
  level: "info"  # debug, info, warn, error
  format: "json"  # json, text
  output: "stdout"  # stdout, stderr, file
  file_path: "/var/log/api-cache.log"
